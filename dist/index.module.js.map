{"version":3,"file":"index.module.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\n\nexport default class extends Controller {\n  static actions = [\n    ['element', 'paste->paste']\n  ];\n\n  get input() {\n    return this.scope.findElement('input[type=file]');\n  }\n\n  paste(e) {\n    if (this.element != document.activeElement) return;\n\n    let input = this.input;\n    let files = this.findFiles(e.clipboardData.items, input.multiple);\n\n    if (files.length) {\n      if (!input.disabled) {\n        input.files = files;\n        input.dispatchEvent(new Event('input', { bubbles: true, cancelable: true }));\n        input.dispatchEvent(new Event('change', { bubbles: true, cancelable: true }));\n        this.dispatch('pasted', { detail: { files: files } });\n        document.activeElement.blur();\n      }\n      e.preventDefault();\n    }\n  }\n\n  findFiles(items, multiple) {\n    let files = Array.from(items).filter(item => item.kind == 'file').map(item => item.getAsFile(item.type));\n    let dt = new DataTransfer();\n    files.forEach(file => {\n      if (multiple || dt.items.length < 1) {\n        dt.items.add(file);\n      }\n    });\n    return dt.files;\n  }\n}\n"],"names":["Controller","input","scope","findElement","paste","e","this","element","document","activeElement","files","findFiles","clipboardData","items","multiple","length","disabled","dispatchEvent","Event","bubbles","cancelable","dispatch","detail","blur","preventDefault","Array","from","filter","item","kind","map","getAsFile","type","dt","DataTransfer","forEach","file","add","actions"],"mappings":"wGAG6BA,EAKvBC,YACF,YAAYC,MAAMC,YAAY,oBAGhCC,MAAMC,GACJ,GAAIC,KAAKC,SAAWC,SAASC,cAA7B,CAEA,IAAIR,EAAQK,KAAKL,MACbS,EAAQJ,KAAKK,UAAUN,EAAEO,cAAcC,MAAOZ,EAAMa,UAEpDJ,EAAMK,SACHd,EAAMe,WACTf,EAAMS,MAAQA,EACdT,EAAMgB,cAAc,IAAIC,MAAM,QAAS,CAAEC,SAAS,EAAMC,YAAY,KACpEnB,EAAMgB,cAAc,IAAIC,MAAM,SAAU,CAAEC,SAAS,EAAMC,YAAY,KACrEd,KAAKe,SAAS,SAAU,CAAEC,OAAQ,CAAEZ,MAAOA,KAC3CF,SAASC,cAAcc,QAEzBlB,EAAEmB,mBAINb,UAAUE,EAAOC,GACf,IAAIJ,EAAQe,MAAMC,KAAKb,GAAOc,OAAOC,GAAqB,QAAbA,EAAKC,MAAgBC,IAAIF,GAAQA,EAAKG,UAAUH,EAAKI,OAC9FC,EAAK,IAAIC,aAMb,OALAxB,EAAMyB,QAAQC,KACRtB,GAAYmB,EAAGpB,MAAME,OAAS,IAChCkB,EAAGpB,MAAMwB,IAAID,KAGVH,EAAGvB,SAlCL4B,QAAU,CACf,CAAC,UAAW"}