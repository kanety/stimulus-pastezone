{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import { Controller } from '@hotwired/stimulus';\nimport '@kanety/stimulus-static-actions';\n\nexport default class extends Controller {\n  static actions = [\n    ['element', 'paste->paste']\n  ];\n\n  get input() {\n    return this.scope.findElement('input[type=file]');\n  }\n\n  paste(e) {\n    if (this.element != document.activeElement) return;\n\n    let input = this.input;\n    let files = this.findFiles(e.clipboardData.items, input.multiple);\n\n    if (files.length) {\n      if (!input.disabled) {\n        input.files = files;\n        input.dispatchEvent(new Event('input', { bubbles: true, cancelable: true }));\n        input.dispatchEvent(new Event('change', { bubbles: true, cancelable: true }));\n        this.dispatch('pasted', { detail: { files: files } });\n        document.activeElement.blur();\n      }\n      e.preventDefault();\n    }\n  }\n\n  findFiles(items, multiple) {\n    let files = Array.from(items).filter(item => item.kind == 'file').map(item => item.getAsFile(item.type));\n    let dt = new DataTransfer();\n    files.forEach(file => {\n      if (multiple || dt.items.length < 1) {\n        dt.items.add(file);\n      }\n    });\n    return dt.files;\n  }\n}\n"],"names":["_Class","Controller","input","this","scope","findElement","paste","e","element","document","activeElement","files","findFiles","clipboardData","items","multiple","length","disabled","dispatchEvent","Event","bubbles","cancelable","dispatch","detail","blur","preventDefault","Array","from","filter","item","kind","map","getAsFile","type","dt","DataTransfer","forEach","file","add","actions"],"mappings":"+EAGeA,MAAAA,UAAcC,EAAAA,WAK3B,SAAIC,GACF,OAAOC,KAAKC,MAAMC,YAAY,mBAChC,CAEAC,KAAAA,CAAMC,GACJ,GAAIJ,KAAKK,SAAWC,SAASC,cAA7B,CAEA,IAAIR,EAAQC,KAAKD,MACbS,EAAQR,KAAKS,UAAUL,EAAEM,cAAcC,MAAOZ,EAAMa,UAEpDJ,EAAMK,SACHd,EAAMe,WACTf,EAAMS,MAAQA,EACdT,EAAMgB,cAAc,IAAIC,MAAM,QAAS,CAAEC,SAAS,EAAMC,YAAY,KACpEnB,EAAMgB,cAAc,IAAIC,MAAM,SAAU,CAAEC,SAAS,EAAMC,YAAY,KACrElB,KAAKmB,SAAS,SAAU,CAAEC,OAAQ,CAAEZ,MAAOA,KAC3CF,SAASC,cAAcc,QAEzBjB,EAAEkB,iBAXJ,CAaF,CAEAb,SAAAA,CAAUE,EAAOC,GACf,IAAIJ,EAAQe,MAAMC,KAAKb,GAAOc,OAAOC,GAAqB,QAAbA,EAAKC,MAAgBC,IAAIF,GAAQA,EAAKG,UAAUH,EAAKI,OAC9FC,EAAK,IAAIC,aAMb,OALAxB,EAAMyB,QAAQC,KACRtB,GAAYmB,EAAGpB,MAAME,OAAS,IAChCkB,EAAGpB,MAAMwB,IAAID,EACf,GAEKH,EAAGvB,KACZ,EACDX,EApCQuC,QAAU,CACf,CAAC,UAAW"}